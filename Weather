from google.colab import files
uploaded = files.upload()

from collections import defaultdict
import sys

# Dictionaries to store sum and count of metrics
metrics_sum = defaultdict(float)
metrics_count = defaultdict(int)

for line in sys.stdin:
    line = line.strip()

    if line:
        # Split the line by spaces or tabs
        parts = line.split()

        try:
            # Extract relevant values
            temperature = float(parts[3])  # 4th column
            dew_point = float(parts[4])    # 5th column
            wind_speed = float(parts[11])  # 12th column

            # Accumulate values
            metrics_sum['temperature'] += temperature
            metrics_sum['dew_point'] += dew_point
            metrics_sum['wind_speed'] += wind_speed

            metrics_count['temperature'] += 1
            metrics_count['dew_point'] += 1
            metrics_count['wind_speed'] += 1

        except ValueError:
            continue

# Output average
for metric in ['temperature', 'dew_point', 'wind_speed']:
    if metrics_count[metric] > 0:
        average = metrics_sum[metric] / metrics_count[metric]
        print(f'{metric}_average\t{average:.2f}')

#!cat sample_weather.txt | python mapreduce_weather.py
